name: E2E Tests
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
jobs:
  test_contrib:
    name: Test running contrib tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      # We always use DDEV, so download it.
      - name: Install ddev
        run: curl -LO https://raw.githubusercontent.com/drud/ddev/master/scripts/install_ddev.sh && bash install_ddev.sh
      - name: Start ddev
        run: ddev start
      - name: Require a module
        run: ddev composer require drupal/gutenberg:2.x-dev
      - name: Run unit tests for said module
        run: ddev exec phpunit web/modules/contrib/gutenberg
  test_core:
    name: Test running core tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      # We always use DDEV, so download it.
      - name: Install ddev
        run: curl -LO https://raw.githubusercontent.com/drud/ddev/master/scripts/install_ddev.sh && bash install_ddev.sh
      - name: Start ddev
        run: ddev start
      - run: ddev composer install
      - name: Run some core tests
        run: ddev exec phpunit web/core/modules/book/tests/src/FunctionalJavascript
